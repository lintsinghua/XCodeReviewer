# 前后端联动配置完成 ✅

## 📌 修改总结

我已经完成了前后端项目的联动配置，主要修改如下：

### 1. 前端配置修改 ✅

#### `vite.config.ts`
- 添加了后端 API 代理配置 (`/api` → `http://localhost:8000`)
- 添加了 WebSocket 代理配置 (`/ws` → `ws://localhost:8000`)

#### `src/shared/services/api/client.ts`
- 更新了 API_BASE_URL 配置，支持开发/生产环境自动切换
- 开发环境使用代理模式 (`/api/v1`)

#### `src/shared/services/api/index.ts`
- 移除了所有 API 端点中重复的 `/api/v1` 前缀
- 修正了所有 API 路径，避免重复

### 2. 新增文件 ✅

#### 文档
- `ENV_CONFIG.md` - 环境变量配置详细说明
- `FRONTEND_BACKEND_INTEGRATION.md` - 前后端集成完整指南
- `INTEGRATION_SUMMARY.md` - 集成总结（英文）
- `前后端联动配置完成.md` - 本文件

#### 工具
- `test-backend-connection.html` - 后端连接测试页面
- `start-dev.sh` - 一键启动脚本
- `stop-dev.sh` - 一键停止脚本

## 🚀 快速开始

### 方式 1: 使用启动脚本（推荐）

```bash
# 一键启动前后端
./start-dev.sh

# 停止服务
./stop-dev.sh
```

### 方式 2: 手动启动

```bash
# 1. 启动后端（在 backend 目录）
cd backend
docker-compose up -d
# 或
python -m uvicorn app.main:app --reload --port 8000

# 2. 启动前端（在项目根目录）
npm run dev
```

### 方式 3: 后端已启动，只启动前端

```bash
# 如果你的后端已经在运行，直接启动前端即可
npm run dev
```

## 🧪 测试连接

### 方法 1: 浏览器测试页面
在浏览器中打开 `test-backend-connection.html` 文件，点击"开始测试"

### 方法 2: 命令行测试
```bash
# 测试后端健康检查
curl http://localhost:8000/health

# 测试项目列表 API
curl http://localhost:8000/api/v1/projects
```

### 方法 3: 前端应用内测试
启动前端后，按 F12 打开开发者工具，在 Console 中执行：
```javascript
fetch('/api/v1/projects').then(r => r.json()).then(console.log)
```

## 📡 API 使用示例

### 在 React 组件中使用

```typescript
import { api } from '@/shared/services/api';

// 获取项目列表
const projects = await api.projects.list({ page: 1 });

// 创建项目
const newProject = await api.projects.create({
  name: '我的项目',
  description: '项目描述'
});

// 用户登录
const auth = await api.auth.login({
  username: 'user@example.com',
  password: 'password'
});
```

## 🔑 环境变量配置（可选）

前端可以在项目根目录创建 `.env.local` 文件：

```bash
# 后端API地址（开发环境默认已配置，无需设置）
VITE_API_BASE_URL=http://localhost:8000/api/v1

# LLM配置（根据需要配置）
VITE_LLM_PROVIDER=gemini
VITE_GEMINI_API_KEY=你的API密钥

# GitHub Token（可选）
VITE_GITHUB_TOKEN=你的GitHub令牌
```

## 🌐 访问地址

启动后可以访问：

- **前端应用**: http://localhost:5173
- **后端 API 文档**: http://localhost:8000/api/v1/docs
- **后端健康检查**: http://localhost:8000/health

## ⚠️ 常见问题

### 1. 前端无法连接后端

**解决方案**:
1. 确认后端正在运行: `curl http://localhost:8000/health`
2. 检查端口 8000 是否被占用
3. 查看浏览器控制台错误信息

### 2. CORS 错误

**原因**: 后端已配置 CORS，允许 `http://localhost:5173` 访问
**解决**: 确保前端运行在 5173 端口（默认）

### 3. API 返回 404

**解决方案**:
1. 访问 http://localhost:8000/api/v1/docs 查看可用 API
2. 检查 API 路径是否正确
3. 确认后端该端点已实现

### 4. 文件上传失败

**解决方案**:
1. 检查文件大小限制
2. 确认文件格式正确（ZIP 文件）
3. 查看后端日志获取详细错误

## 📖 详细文档

- **完整集成指南**: `FRONTEND_BACKEND_INTEGRATION.md`
- **环境变量说明**: `ENV_CONFIG.md`
- **集成总结**: `INTEGRATION_SUMMARY.md`

## ✅ 配置清单

- ✅ Vite 代理配置
- ✅ API Client 配置
- ✅ API 端点路径修正
- ✅ 后端 CORS 验证
- ✅ 测试工具
- ✅ 启动脚本
- ✅ 文档完善

**所有配置已完成，可以开始使用了！** 🎉

## 💡 下一步

1. 启动前后端服务
2. 使用测试页面验证连接
3. 开始开发你的功能
4. 参考 API 文档了解可用接口

---

**配置日期**: 2025-11-02  
**配置状态**: ✅ 完成

如有问题，请参考详细文档或查看后端 API 文档。

